{{template "base" .}}

{{define "title"}}Wiki Pages{{end}}

{{define "content"}}
    <nav>
        <h3>Categories</h3>
        <ul>
            {{range $node := .CategoryTree}}
            <li>
                <a href="/category/{{$node.Parent.Name}}">{{$node.Parent.Name}}</a>
                {{if $node.Children}}
                <ul>
                    {{range $node.Children}}
                    <li><a href="/category/{{$node.Parent.Name}}/{{.Name}}">{{.Name}}</a></li>
                    {{end}}
                </ul>
                {{end}}
            </li>
            {{end}}
        </ul>
    </nav>
    <hr>
    <h2>All Pages</h2>
    <table>
        <thead>
            <tr>
                <th>Title</th>
            </tr>
        </thead>
        <tbody>
            {{range .Pages}}
            <tr>
                <td><a href="/view/{{.Title}}">{{.Title}}</a></td>
            </tr>
            {{end}}
        </tbody>
    </table>
    <footer class="page-footer">
        {{range .UserInfo.Roles}}
            {{if eq . "editor"}}
                <a href="/edit/NewPage">Create a new page</a>
                | <a href="/categories">Categories</a>
            {{end}}
        {{end}}
        <br><br>
        <a href="/view/Home">Back to Home</a>
    </footer>
{{end}}
